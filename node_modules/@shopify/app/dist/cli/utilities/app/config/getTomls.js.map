{"version":3,"file":"getTomls.js","sourceRoot":"","sources":["../../../../../src/cli/utilities/app/config/getTomls.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,QAAQ,EAAC,MAAM,4BAA4B,CAAA;AACnD,OAAO,EAAC,UAAU,EAAC,MAAM,4BAA4B,CAAA;AACrD,OAAO,EAAC,YAAY,EAAE,WAAW,EAAC,MAAM,IAAI,CAAA;AAE5C,MAAM,CAAC,KAAK,UAAU,QAAQ,CAAC,IAA8B,EAAE,YAAqB;IAClF,IAAI,CAAC,YAAY,EAAE;QACjB,OAAO,EAAE,CAAA;KACV;IAED,MAAM,KAAK,GAAG,iCAAiC,CAAA;IAC/C,MAAM,SAAS,GAA4B,EAAE,CAAA;IAE7C,WAAW,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;QACzC,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YACpB,MAAM,QAAQ,GAAG,QAAQ,CAAC,YAAY,EAAE,IAAI,CAAC,CAAA;YAC7C,MAAM,WAAW,GAAG,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAA;YAClD,8DAA8D;YAC9D,MAAM,UAAU,GAAyB,UAAU,CAAC,WAAW,CAAC,CAAA;YAEhE,IAAI,UAAU,CAAC,SAAS,EAAE;gBACxB,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,IAAI,CAAA;aACvC;SACF;IACH,CAAC,CAAC,CAAA;IAEF,OAAO,SAAS,CAAA;AAClB,CAAC","sourcesContent":["import {OrganizationAppsResponse} from '../../../services/dev/fetch.js'\nimport {joinPath} from '@shopify/cli-kit/node/path'\nimport {decodeToml} from '@shopify/cli-kit/node/toml'\nimport {readFileSync, readdirSync} from 'fs'\n\nexport async function getTomls(apps: OrganizationAppsResponse, appDirectory?: string) {\n  if (!appDirectory) {\n    return {}\n  }\n\n  const regex = /^shopify\\.app(\\.[-\\w]+)?\\.toml$/\n  const clientIds: {[key: string]: string} = {}\n\n  readdirSync(appDirectory).forEach((file) => {\n    if (regex.test(file)) {\n      const filePath = joinPath(appDirectory, file)\n      const fileContent = readFileSync(filePath, 'utf8')\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const parsedToml: {[key: string]: any} = decodeToml(fileContent)\n\n      if (parsedToml.client_id) {\n        clientIds[parsedToml.client_id] = file\n      }\n    }\n  })\n\n  return clientIds\n}\n"]}